# Database

 

## 1. 简述MySQL和Redis的区别

- **Redis**: 内存型非关系数据库，数据是以Key-Value的形式保存在内存中的，读取速度快
- **MySQL**: 关系型数据库，数据保存在磁盘中，检索的话，会有一定的IO操作，访问速度相对较慢

## 2. Oracle和MySQL的区别

- **函数库不同**
- **Oracle是用表空间来管理，MySQL不是**
- **显示当前所有的表、用户、改变链接用户、显示当前连接用户、执行外部脚本的语句不同**
- **分页查询时，MySQL用limit， Oracle用rownum**

## 3. 数据库的三范式

- **第一范式**: 强调的是列的原子性，即列不能再分成其他几列。
- **第二范式**: 在第一范式的基础上，包含另外两个部分，一是表必须有一个主键，而没有包含在主键中的列必须完全依赖主键，而不能只依赖主键的一部分。
- **第三范式**: 在第一范式和第二范式的基础上，非主键列必须直接依赖于主键，不能存在传递关系。

## 4. 列出MySQL常见的数据存储引擎

- **InnoDB**: 支持事物处理，支持外键，支持崩溃修复能力和并发控制。如果需要对事物的完整性要求比较高(比如银行)，要求实现并发机制(如受骗)，那么选择InnoDB有很大的优势。如果需要频繁更新、删除操作数据库，可以选择InnoDB，因为支持事物的提交(commit)和滚动(rollback)。
- **MyISAM**: 插入数据快，空间和内存使用比较低。如果表主要是用于插入新纪录和读出纪录，那么选择MyISAM能实现处理高效率。如果应用的完整性、并发性要求比较低，也可以使用。
- **MEMORY**: 所有的数据都在内存空间中，数据的处理速度快，但是安全性不高。如果需要快速的读写速度，对数据的完整性要求比较低，可以选择MEMORY。它对表的大小有要求，不能建立太大的表。所以，这类数据库值使用在相对较小的数据库表中。

## 5. MyISAM 与 InnoDB的区别

- **1、**InnoDB支持事物，MyISAM不支持事物，这点很重要，因为事物是一种高级的处理方式，如在一些列增删改查种只要哪个出错还可以回滚还原，而MyISAM不可以。
- **2、**MyISAM适合查询以及插入为主的应用，InnoDB适合频繁修改以及涉及安全性较高的应用。
- **3、**InnoDB支持外键，MyISAM不支持。
- **4、**对于自增长的字段，InnoDB中必须包含只有该字段的索引，但是在MyISAM表中可以和其他字段一起建立联合索引。
- **5、**清空整个表时，InnoDB是一行一行的删除，效率非常慢。MyISAM则会重建表

## 6. MySQL的特点

- **1、**使用C和C++编写，并使用了多种编译器进行测试，保证源代码的可移植性
- **2、**支持多种操作系统，如Linux、Windows、AIX、macOS等
- **3、**为多种编程语言提供了API，如C、C++、Python、Java等
- **4、**支持多线程，充分利用CPU资源
- **5、**优化的SQL查询算法，有效地提高查询速度
- **6、**提供多种编码支持，常见的有GB2312、UTF8
- **7、**提供TCP/IP、ODBC和JDBC等多种数据库连接途径
- **8、**提供了用于管理，检查，优化数据操作的管理工具
- **9、**大型的数据库。可以处理拥有上万条记录的大型数据库
- **10、**支持多种存储引擎

## 7. 什么是RDBMS

RDBMS(Relational Datavase Management System)是建立在关系模型上的数据库，借助于集合代数等数学概念和方法来处理数据库中的数据

## 8. 什么是数据完整性

一个数据库就时一个完整的业务单元，可以包含多张表，数据被存储在表中，在表中为了更加准确的存储数据，保证数据的正确有效，可以在创建表的时候，为表添加一些强制性的验证，包含数据字段的类型、约束。

## 9. 什么是超键、候选建、主键、外键

- **超键**: 在关系中能唯一标识元祖的属性集称为关系模式的超键。一个属性可以作为一个超键，多个属性组合在一起也可以作为一个超键。超键包含主键和候选建
- **候选建**: 是最小的超键，即没有冗余元素的超键
- **主键**: 数据库表中对存储数据对象予以唯一和完整标识的数据列或属性的组合。一个数据列只能有一个主键，而且主键的取值不能缺失，即不能为null。
- **外键**: 在一个表中存在的另一个表的主键称为此表的外键。

## 10. 主键和外键的区别

主键在本表中是唯一的，不可为空，外键可以重复可以为空；外键和另一张表的主键关联，不能创建对应表中不存在的外键

## 11. 数据表student有id，name，score，city字段，其中name中的名字可以有重复，需要消除重复，写出sql语句

```mysql
select distinct name from student;
```

## 12. Drop、delete、truncate的区别，分别在什么场景使用

- drop、delete、truncate都表示删除，从速度上讲 drop > truncate > delete
- delete语句是dml，这个操作会放到rollback segement中，事物提交后才生效；如果有相应的triggger，执行时将被触发
- truncate和drop是ddl，操作立即生效，原数据不放到 rollback segment中，不能回滚，操作不触发trigger
- 使用场景:
  - 不需要一张表时使用drop
  - 想删除部分数据行的时候，用delete 并且带上 where字句
  - 保留表而删除所有数据的时候使用truncate

## 13. 数据库优化查询方法

**外键、索引、联合查询、选择特定字段等等**

## 14. 索引的作用 它的优缺点是什么

索引就是一种特殊的查询表，数据库的搜索可以利用它加速对数据的检索。它很类似于现实生活中书的目录，不需要要查询整本书内容就可以查找想要的数据。索引可以是唯一的，创建索引允许指定单个列或者多个列。缺点是它减慢了数据的录入速度，同时也增加了数据库的尺寸大小。

## 15. 索引的类型有哪些

- **逻辑上**: 
  - single column-------------单个索引
  - concatenated-------------多行索引
  - unique-----------------------唯一索引
  - function-based-----------函数索引
  - domain----------------------域索引
- **物理上**:
  - Partitioned-----------------分区索引
  - NonPartitioned-----------非分区索引

## 16.什么样的字段适合做索引

**唯一、不为空、经常被查询的字段**

## 17. 索引是什么，有什么作用以及优缺点

**索引是对数据库表中以或多个列值进行排序的结构，是帮助MySQL高效获取数据的数据结构**

- **优点**:
  - 索引加快数据库的检索速度
  - 可确保每行数据的唯一性
  - 通过索引可以查询过程中使用优化隐藏器，提高系统的性能
- **缺点**:
  - 索引降低了插入、删除、修改等维护任务的速度
  - 索引需要占用物理和数据空间

## 18. 使用索引查询一定能提高查询的性能嘛，为什么

通常通过索引查询数据比全面扫描要快，但是也必须注意他的代价。索引需要空间来存储，也需要定期维护，每当有记录在表中增减或索引列被修改时，索引本身也会被修改。这意味着每条记录的INSERT、DELETE、UPDATE将为此付出4、5次的批判IO。因为索引需要额外的空间和处理，那些不必要的索引返回会使查询反应的时间变慢。使用索引不一定能提高查询性能，索引范围查询(INDEX RANGE SCAN)适用于两种情况:

- 基于一个范围的检查，一般查询返回结果集小于表中记录数的30%
- 基于非唯一性的检索

## 19. 什么是存储过程，用什么调用

存储过程是一些预编译的SQL语句。存储过程相当于一个记录集，它是由一些T-SQL语句组成的代码块，这些T-SQL语句代码像一个方法一样实现一些功能(例如: 对表单或多表的增删改查)，然后再给这个代码块取一个名字，在用到这个功能的时候调用它就行了。

## 20. 存储过程的优缺点

- **优点**:
  - 1、存储过程是预编译过的，执行效率高
  - 2、存储过程的代码直接存放于数据库中，通过存储过程名直接调用减少网络通讯
  - 3、安全性高，执行存储过程需要有一定权限的用户
  - 4、存储过程可以重复使用，可减少数据库开发人员的工作量
  - 5、一个存储过程替代大量T-SQL语句，可以降低网络通信量，提高通信速率
  - 6、可以在一定程度上确保数据的安全
- **缺点**:
  - 移植性差

## 21. 存储过程与函数的区别

- **存储过程**
  - 1、用于在数据库中完成特定操作或者任务(如插入、删除等)
  - 2、程序头部声明用procedure
  - 3、程序头部声明时不需要描述返回类型可以用in/out/in out 三种模式
  - 4、可以作为一个独立的PL/SQL语句来执行
  - 5、可以通过out/in out返回零个或多个值
  - 6、SQL语句(DML或SELECT)中不可调用存储过程
- **函数**
  - 1、用于特定的数据
  - 2、程序头部声明用function
  - 3、程序头部申明时要描述返回类型，而且PL/SQL块中至少要包括一个有效的return语句
  - 4、可以使用in/out/in out 三种模式的参数
  - 5、不能独立执行，必须作为表达式的一部分调用
  - 6、通过return语句返回一个值，且该值需要与声明部分一致，也可以是通过out类型的参数带出的变量
  - 7、SQL语句(DML或SELECT)中可以调用函数

## 22. varchar2和varchar有何区别

char长度是固定的，而varchar2的长度是可以变化的。char的效率要比varchar2高。目前varchar是varchar的同义词，工业标准的varchr类型可以存储空字符串，但是Oracle不能这样做，尽快它保留以后这样做的权利。Oracle自己开发了一个数据类型varchar2，这个类不是一个标准的varchar，它将在数据库中varchar列可以存储空字符串的特殊性改为存储null值，如果想有向后的兼容能力，Oracle建议使用varchar2而不是varchar。

## 23. union和union all有什么不同

union在进行表连接后会筛选掉重复的记录，所以在表连接后刽对所产生的结果集进行排序运算，删除重复的记录再返回结果。实际上大部分应用中是不会产生重复的记录，最常见的事过程表与历史表UNION  union all只是简单的将两个结果合并后返回。这样，如果返回的两个结果集中有重复的数据，那么返回的结果集会包含重复的数据流。从效率上说，union all 要比union快很多，所以，如果可以确认合并的两个结果集中不包含重复的数据的话，那么就使用union all。

## 24. 简述数据库的约束

- **主键(primary key)**: 物理上的存储顺序
- **非空(not null)**: 此字段不允许为空
- **唯一(unique)**: 此字段的值不允许重复
- **默认(default)**: 当不填写此字段的值时，会使用默认值
- **外键(foreign key)**: 对关系字段进行约束，当为关系字段

## 25. 什么是事物 什么是锁

- **事物**: 事物(Transaction)是并发控制的基本单位。事物是一个操作序列，这些操作要么执行，要么不执行。事物是数据库维护数据一致性的单位，在每个事物结束时，都能保持数据的一致性。事物就是被绑定在一起为一个逻辑工作单元的SQL语句分组，如果任何一个语句操作失败，那么整个操作就会失败，以后操作就会回滚到操作前的状态，或者是上一个节点。为了确保要么执行，要么不执行，就可以使用事务。要将有组语句作为事务考虑，就需要通过ACID测试，即原子性、一致性、隔离性、持久性。
- **锁**: 在所有的DBMS中，锁是实现事务的关键，锁可以保证事务的完整性和并发性。与现实生活中的锁一样，它可以使某些数据的拥有者，在某段时间内不能使用某些数据或数据结构。当然，锁还分级别。

## 27. 什么是视图，以及视图的使用场景

视图是一种虚拟表，具有和物理表相同的功能，可以对视图表进行增、改、差操作，视图通常是一个表或者多个表的行或例的子集。对视图的修改不影响基本几班表。它使得我们获取数据更改容易。

## 28. 视图的优缺点

- **优点**: 
  - 1、对数据库的访问，因为视图可以有选择性的选取数据库里的一部分
  - 2、用户通过简单的查询可以从复杂查询中得到结果
  - 3、维护数据的独立性、视图可以从多个表检索数据
  - 4、对于相同的数据可产生不同的视图
- **缺点**:
  - 性能，查询视图时，必须要吧视图的查询转化成对基本表的查询，如果这个视图是由一个复杂的多表查询所定义，那么就无法更改数据。

## 29. 触发器的作用

触发器是一种特殊的存储过程，主要是通过事件来触发然后被执行的。它可以强化约束，来维护数据的完整性和一致性，可以跟踪数据库内的操作从而不允许未经许可的更新和变化。可以联级运算。如，某表上的触发器包含一个表的数据操作，而该操作又会导致该表出发器被触发。

## 30. 列举集中链接的方式，有何区别

- **内连接**: 只有两个规格元素表相匹配的才能在结果集中显示
- **外连接**:左外连接--坐标为驱动表，驱动表的数据全部显示，匹配表的不匹配的不会显示。右外连接--右边为驱动表，驱动表的数据全部显示，匹配表的不匹配不会显示。
- **全外连接**: 连接表中不匹配的数据全部显示
- **交叉连接**: 笛卡尔效应，显示的结果是链接表数的乘积

## 31. 在数据库建模过程中如果要删除某条数据，什么时候用物理删除，什么时候用逻辑删除，如何区分

- **物理删除**: 指文件存储所用的磁盘存储区域被真正的擦除后清零，这样删除的文件是不可以恢复的，物理删除是计算机处理的一个概念。如果在数据库中直接使用delete、drop删除了表数据，如果没有备份的话，数据就很难恢复了。
- **逻辑删除**:逻辑删除就是对要被删除的数据上打一个删除标记，通常使用一个is_deleted字段标示行记录是不是被删除，在逻辑上过数据是被删除的，但是数据本身依然是存在的。
- **区别**:物理删除一定程度上删除了暂时”无用“的数据，降低了表的数量，对性能有一定的好处；但是如果没有备份的话，数据很难恢复。逻辑删除恢复的话只需要修改is_deleted等类似的状态标示字段就可以了，但是表的数据量肯定会比物理删除增加了，并且查询时经常考虑is_deleted字段，对索引都会有影响。

## 32. 数据库的乐观锁和悲观锁是什么

**数据库管理系统(DBMS)中的并发控制的任务是确保在多个事务同时存取数据库中同一数据时不破坏事务的隔离性和统一性以及数据库的统一性。而乐观锁和悲观锁是并发控制采用的主要技术手段。**

- **悲观锁**:假定会发生并发冲突，屏蔽一切可能违反数据完整性的操作
- **乐观锁**: 假定不会发生并发冲突，只在提交操作时检查是否违反数据完整性

## 33. 数据库中查询语句速度很慢，如何优化

- **1、**键索引
- **2、**减少表之间的关联
- **3、**优化sql，尽量让sql很快定位数据，不要让sql做全表查询，应走索引，把数据量大的表排在前面
- **4、**简化查询字段，没用的字段不要，以及对返回结果的控制，尽量返回少量数据
- **5、**尽量用PreparedStatement来查询，不要Stateement

## 34. 距离说明SQL注入和解决办法

当以字符串格式化书写方式的时候，乳沟用户输入的有 ”+SQL语句，后面的SQL语句hi执行“

解决方式：通过传参方式解决SQL注入

## 35. MySQL 怎么限制IP访问

## 36. 简单介绍MongoDB数据库

MongoDB是基于分布式文件存储的非关系型数据库

## 37. 简单介绍一下redis

## 38. Redis集群





